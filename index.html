<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî• T≈Çumacz Polsko-Mitrolski - POPRAWNY ALGORYTM</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 1200px;
            width: 100%;
            padding: 40px;
        }
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 5px;
            font-size: 2.5em;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 0.9em;
        }
        .translator-box {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
            align-items: start;
        }
        .input-section {
            display: flex;
            flex-direction: column;
        }
        .language-label {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        textarea {
            width: 100%;
            height: 280px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            resize: vertical;
            transition: border-color 0.3s;
            font-family: 'Courier New', monospace;
        }
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        .pronunciation-box {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
            border: 2px solid #667eea;
        }
        .pronunciation-box strong {
            color: #667eea;
            font-size: 16px;
        }
        .pronunciation-text {
            font-family: 'Courier New', monospace;
            font-size: 18px;
            color: #333;
            margin-top: 10px;
            padding: 10px;
            background: white;
            border-radius: 5px;
            min-height: 40px;
        }
        @media (max-width: 768px) {
            .translator-box {
                grid-template-columns: 1fr;
            }
            h1 {
                font-size: 1.8em;
            }
        }
        
        /* STYLE DLA GRY */
        .game-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .game-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
        }
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        .close-game {
            font-size: 30px;
            cursor: pointer;
            color: #666;
            background: none;
            border: none;
        }
        .game-stats {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f0f0f0;
            border-radius: 10px;
        }
        .stat-box {
            flex: 1;
            text-align: center;
        }
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }
        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        .question-box {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        .question-text {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        .question-subtext {
            font-size: 16px;
            color: #666;
            margin-bottom: 20px;
        }
        .answer-input {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        .answer-buttons {
            display: flex;
            gap: 10px;
        }
        .game-button {
            flex: 1;
            padding: 15px;
            font-size: 16px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        .check-btn {
            background: #667eea;
            color: white;
        }
        .skip-btn {
            background: #f0f0f0;
            color: #666;
        }
        .feedback {
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        }
        .feedback.correct {
            background: #d4edda;
            color: #155724;
        }
        .feedback.wrong {
            background: #f8d7da;
            color: #721c24;
        }
        .game-settings {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .setting-option {
            flex: 1;
        }
        .setting-label {
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .option-button {
            width: 100%;
            padding: 20px;
            font-size: 20px;
            border: 3px solid #ddd;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            text-align: left;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .option-button:hover:not(:disabled) {
            border-color: #667eea;
            background: #f8f9fa;
            transform: translateX(5px);
        }
        .option-letter {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            flex-shrink: 0;
        }
        .option-button.correct-answer {
            border-color: #28a745;
            background: #d4edda;
        }
        .option-button.correct-answer .option-letter {
            background: #28a745;
        }
        .option-button.selected-correct {
            border-color: #28a745;
            background: #d4edda;
            border-width: 4px;
        }
        .option-button.selected-wrong {
            border-color: #dc3545;
            background: #f8d7da;
            border-width: 4px;
        }
        .option-button.selected-wrong .option-letter {
            background: #dc3545;
        }
        .option-button:disabled {
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
            <div style="flex: 1;">
                <h1>üî• T≈Çumacz Polsko-Mitrolski</h1>
            </div>
            <button onclick="openGame()" style="padding: 15px 30px; font-size: 18px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); transition: all 0.3s; white-space: nowrap;">
                üéÆ Zagraj w grƒô
            </button>
        </div>

        <div class="translator-box">
            <div class="input-section">
                <div class="language-label">üáµüá± Polski</div>
                <textarea id="leftText" placeholder="Wpisz tekst po polsku..."></textarea>
            </div>

            <div class="input-section">
                <div class="language-label">üî• Mitrolski</div>
                <textarea id="rightText" placeholder="Wynik pojawi siƒô automatycznie..." readonly></textarea>
            </div>
        </div>

        <div class="pronunciation-box">
            <strong>üîä Wymowa:</strong>
            <button onclick="speakCurrentWord()" style="margin-left: 10px; padding: 8px 15px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 14px;">
                üîä S≈Çuchaj
            </button>
            <div class="pronunciation-text" id="pronunciationText">Wpisz co≈õ po lewej stronie...</div>
        </div>
    </div>

    <script>
        // KONWERSJA S≈ÅOWNYCH LICZB NA CYFRY
        const LICZBY_SLOWNE = {
            'zero': '0', 'jeden': '1', 'dwa': '2', 'trzy': '3', 'cztery': '4',
            'piƒôƒá': '5', 'sze≈õƒá': '6', 'siedem': '7', 'osiem': '8', 'dziewiƒôƒá': '9',
            'dziesiƒôƒá': '10', 'jedena≈õcie': '11', 'dwana≈õcie': '12', 'trzyna≈õcie': '13',
            'czterna≈õcie': '14', 'piƒôtna≈õcie': '15', 'szesna≈õcie': '16', 'siedemna≈õcie': '17',
            'osiemna≈õcie': '18', 'dziewiƒôtna≈õcie': '19', 'dwadzie≈õcia': '20',
            'trzydzie≈õci': '30', 'czterdzie≈õci': '40', 'piƒôƒádziesiƒÖt': '50',
            'sze≈õƒádziesiƒÖt': '60', 'siedemdziesiƒÖt': '70', 'osiemdziesiƒÖt': '80',
            'dziewiƒôƒádziesiƒÖt': '90', 'sto': '100', 'dwie≈õcie': '200', 'trzysta': '300',
            'czterysta': '400', 'piƒôƒáset': '500', 'sze≈õƒáset': '600', 'siedemset': '700',
            'osiemset': '800', 'dziewiƒôƒáset': '900', 'tysiƒÖc': '1000', 'milion': '1000000'
        };

        // LICZBY PO ANGIELSKU (do wymowy mitrolskiej)
        const NUMBER_TO_ENGLISH = {
            '0': 'zero', '1': 'one', '2': 'two', '3': 'three', '4': 'four',
            '5': 'five', '6': 'six', '7': 'seven', '8': 'eight', '9': 'nine',
            '10': 'ten', '11': 'eleven', '12': 'twelve', '13': 'thirteen', 
            '14': 'fourteen', '15': 'fifteen', '16': 'sixteen', '17': 'seventeen',
            '18': 'eighteen', '19': 'nineteen', '20': 'twenty', '21': 'twenty one',
            '22': 'twenty two', '23': 'twenty three', '24': 'twenty four',
            '25': 'twenty five', '26': 'twenty six', '27': 'twenty seven',
            '28': 'twenty eight', '29': 'twenty nine', '30': 'thirty',
            '40': 'forty', '50': 'fifty', '60': 'sixty', '70': 'seventy',
            '80': 'eighty', '90': 'ninety', '100': 'hundred', '1000': 'thousand',
            '1000000': 'million'
        };

        function convertNumberWordsToDigits(text) {
            let result = text;
            
            // Zamie≈Ñ s≈Çowne liczby na cyfry
            for (let [word, digit] of Object.entries(LICZBY_SLOWNE)) {
                const regex = new RegExp('\\b' + word + '\\b', 'gi');
                result = result.replace(regex, digit);
            }
            
            // ≈ÅƒÖcz sƒÖsiadujƒÖce cyfry (bez pauzy = jedna liczba)
            // "20 3" (dwadzie≈õcia trzy) ‚Üí "23"
            // Wielokrotne przebiegi dla zagnie≈ºd≈ºonych liczb
            let prevResult = '';
            while (prevResult !== result) {
                prevResult = result;
                
                // TysiƒÖce + reszta: "1000 123" ‚Üí "1123"
                result = result.replace(/\b(\d+000)\s+(\d{1,3})\b/g, (match, thousands, rest) => {
                    return (parseInt(thousands) + parseInt(rest)).toString();
                });
                
                // Setki + reszta: "100 23" ‚Üí "123"
                result = result.replace(/\b(\d00)\s+(\d{1,2})\b/g, (match, hundreds, rest) => {
                    return (parseInt(hundreds) + parseInt(rest)).toString();
                });
                
                // DziesiƒÖtki + jedno≈õci: "20 3" ‚Üí "23"
                result = result.replace(/\b([2-9]0)\s+([1-9])\b/g, (match, tens, ones) => {
                    return (parseInt(tens) + parseInt(ones)).toString();
                });
            }
            
            return result;
        }

        // Konwersja liczby na system mieszany arabsko-rzymski
        function toMixedArabicRoman(num) {
            const arabicToRoman = {
                '1': 'I', '2': 'II', '3': 'III', '4': 'IV', '5': 'V',
                '6': 'VI', '7': 'VII', '8': 'VIII', '9': 'IX', '0': '0'
            };
            
            const digits = num.toString().split('');
            let result = '';
            
            for (let i = 0; i < digits.length; i++) {
                const digit = digits[i];
                
                // Pozycja: parzysta = arabska, nieparzysta = rzymska
                if (i % 2 === 0) {
                    // Arabska - ZAWSZE dodaj (nawet 0)
                    result += digit;
                } else {
                    // Rzymska - dla zera te≈º daj 0
                    if (digit === '0') {
                        result += '0';
                    } else {
                        result += arabicToRoman[digit] || digit;
                    }
                }
            }
            
            return result;
        }

        // T≈Çumacz liczbƒô na mitrolski (rozbija na tysiƒÖce, setki, dziesiƒÖtki)
        // UWAGA: Zero w zapisie zostaje, ale w wymowie siƒô pomija!
        function numberToMitrolski(num) {
            const n = parseInt(num);
            let parts = [];
            
            if (n === 0) {
                // zero ‚Üí orez ‚Üí rez (usu≈Ñ 'o')
                return cleanMitrolskiRules('orez');
            }
            
            // TysiƒÖce
            const thousands = Math.floor(n / 1000);
            if (thousands > 0) {
                if (thousands === 1) {
                    // thousand ‚Üí dnasuoht ‚Üí dnsuht (po zasadach)
                    parts.push(cleanMitrolskiRules('dnasuoht'));
                } else {
                    // Np. 5000 = "five thousand"
                    parts.push(numberToMitrolski(thousands.toString()));
                    parts.push(cleanMitrolskiRules('dnasuoht'));
                }
            }
            
            const remainder = n % 1000;
            
            // Setki
            const hundreds = Math.floor(remainder / 100);
            if (hundreds > 0) {
                if (hundreds === 1) {
                    // hundred ‚Üí derdnuh (po zasadach, ju≈º ok)
                    parts.push(cleanMitrolskiRules('derdnuh'));
                } else {
                    // Np. 5 hundred
                    const hundredsWord = NUMBER_TO_ENGLISH[hundreds.toString()];
                    if (hundredsWord) {
                        const reversed = hundredsWord.split('').reverse().join('');
                        parts.push(cleanMitrolskiRules(reversed));
                    }
                    parts.push(cleanMitrolskiRules('derdnuh'));
                }
            }
            
            const lastTwo = remainder % 100;
            
            // 10-99
            if (lastTwo >= 10 && lastTwo < 20) {
                // 10-19 (specjalne s≈Çowa)
                const english = NUMBER_TO_ENGLISH[lastTwo.toString()];
                if (english) {
                    const reversed = english.split('').reverse().join('');
                    parts.push(cleanMitrolskiRules(reversed));
                }
            } else if (lastTwo >= 20) {
                // 20-99
                const tens = Math.floor(lastTwo / 10) * 10;
                const ones = lastTwo % 10;
                
                const tensWord = NUMBER_TO_ENGLISH[tens.toString()];
                if (tensWord) {
                    const reversed = tensWord.split('').reverse().join('');
                    parts.push(cleanMitrolskiRules(reversed));
                }
                
                if (ones > 0) {
                    const onesWord = NUMBER_TO_ENGLISH[ones.toString()];
                    if (onesWord) {
                        const reversed = onesWord.split('').reverse().join('');
                        parts.push(cleanMitrolskiRules(reversed));
                    }
                }
                // UWAGA: Je≈õli ones === 0, nie dodajemy nic (pomijamy zero w wymowie)
            } else if (lastTwo > 0 && lastTwo < 10) {
                // 1-9
                const english = NUMBER_TO_ENGLISH[lastTwo.toString()];
                if (english) {
                    const reversed = english.split('').reverse().join('');
                    parts.push(cleanMitrolskiRules(reversed));
                }
            }
            // UWAGA: Je≈õli lastTwo === 0, nie dodajemy nic (pomijamy zero w wymowie)
            
            return parts.filter(p => p).join(' ');
        }

        // S≈ÅOWNIK POLSKO-ANGIELSKI (122 s≈Çowa - tylko podstawowe formy)
        const POLISH_TO_ENGLISH = {"pa":"bye","nara":"bye","do widzenia":"goodbye","≈ºegnaj":"goodbye","hej":"hey","cze≈õƒá":"hello","elo":"hello","siema":"hello","dziƒôki":"thanks","dziƒôkujƒô":"thank you","proszƒô":"please","tak":"yes","nie":"no","mo≈ºe":"maybe","kurwa":"fuck","chuj":"dick","dupa":"ass","dupek":"asshole","pierdoliƒá":"fuck","jebaƒá":"fuck","g√≥wno":"shit","dziwka":"bitch","suka":"bitch","skurwysyn":"bastard","zjebany":"fucked up","pojebany":"crazy","spierdalaj":"fuck off","wypierdalaj":"get out","zajebisty":"awesome","wkurwiony":"pissed","najebany":"drunk","rozjebany":"destroyed","pizda":"cunt","cipka":"pussy","fiut":"cock","kutas":"cock","cycki":"tits","sraƒá":"shit","pieprzyƒá":"fuck","ruchaƒá":"fuck","peda≈Ç":"faggot","ciota":"faggot","debil":"idiot","idiota":"idiot","kretyn":"moron","palant":"jerk","g≈Çupi":"stupid","cz≈Çowiek":"human","ludzie":"people","osoba":"person","mƒô≈ºczyzna":"man","kobieta":"woman","dziecko":"child","ch≈Çopiec":"boy","dziewczynka":"girl","mama":"mom","tata":"dad","matka":"mother","ojciec":"father","syn":"son","c√≥rka":"daughter","brat":"brother","siostra":"sister","pies":"dog","kot":"cat","ko≈Ñ":"horse","krowa":"cow","≈õwinia":"pig","ptak":"bird","ryba":"fish","dom":"home","mieszkanie":"apartment","pok√≥j":"room","kuchnia":"kitchen","≈Çazienka":"bathroom","drzwi":"door","okno":"window","st√≥≈Ç":"table","krzes≈Ço":"chair","dzie≈Ñ":"day","noc":"night","rano":"morning","wiecz√≥r":"evening","rok":"year","miesiƒÖc":"month","tydzie≈Ñ":"week","godzina":"hour","minuta":"minute","teraz":"now","jutro":"tomorrow","wczoraj":"yesterday","jedzenie":"food","woda":"water","mleko":"milk","chleb":"bread","miƒôso":"meat","ry≈º":"rice","jab≈Çko":"apple","banan":"banana","byƒá":"be","mieƒá":"have","robiƒá":"do","i≈õƒá":"go","widzieƒá":"see","wiedzieƒá":"know","chcieƒá":"want","m√≥c":"can","musieƒá":"must","kochaƒá":"love","lubiƒá":"like","je≈õƒá":"eat","piƒá":"drink","dobry":"good","z≈Çy":"bad","wielki":"big","ma≈Çy":"small","nowy":"new","stary":"old","piƒôkny":"beautiful","brzydki":"ugly","szybki":"fast","wolny":"slow"};

        // ALGORYTM MITROLSKIEGO
        function cleanMitrolskiRules(word) {
            if (!word) return "";
            word = word.toLowerCase();
            word = word.replace(/[^a-z]/g, '');
            word = word.replace(/[awop]/g, '');
            while (word && 'yxwzk'.includes(word[0])) word = word.slice(1);
            while (word && 'yxwzk'.includes(word[word.length-1])) word = word.slice(0, -1);
            return word;
        }

        function polishToMitrolski(polishWord) {
            // 1. T≈Çumacz na angielski
            const english = POLISH_TO_ENGLISH[polishWord.toLowerCase()] || polishWord;
            
            // 2. Odwr√≥ƒá
            const reversed = english.split('').reverse().join('');
            
            // 3. Zastosuj zasady
            const mitrolski = cleanMitrolskiRules(reversed);
            
            return mitrolski || polishWord;
        }

        // Funkcja do odtwarzania wymowy
        function speakPronunciation(text) {
            if (!text || !window.speechSynthesis) {
                alert('Twoja przeglƒÖdarka nie obs≈Çuguje syntezy mowy!');
                return;
            }
            window.speechSynthesis.cancel();
            
            // NOWE PODEJ≈öCIE: Czytaj s≈Çowa mitrolskie JAK SƒÑ
            // Dodaj tylko ma≈Çe pauzy miƒôdzy s≈Çowami
            const textWithPauses = text.replace(/\s+/g, ', ');
            
            const utterance = new SpeechSynthesisUtterance(textWithPauses);
            
            // Szukaj kobiecego g≈Çosu angielskiego
            const voices = window.speechSynthesis.getVoices();
            const englishFemaleVoice = voices.find(voice => 
                (voice.lang.startsWith('en-') || voice.lang === 'en') && 
                (voice.name.toLowerCase().includes('female') || voice.name.toLowerCase().includes('woman'))
            ) || voices.find(voice => 
                voice.lang.startsWith('en-')
            );
            
            if (englishFemaleVoice) {
                utterance.voice = englishFemaleVoice;
            }
            
            utterance.lang = 'en-US'; // Angielski z USA
            utterance.rate = 0.75; // WOLNIEJ - ≈ºeby pr√≥bowa≈Ç czytaƒá jako s≈Çowa
            utterance.pitch = 1.1; // Wy≈ºszy ton (kobiecy)
            
            window.speechSynthesis.speak(utterance);
        }
        
        // Za≈Çaduj g≈Çosy przy starcie
        if (window.speechSynthesis.onvoiceschanged !== undefined) {
            window.speechSynthesis.onvoiceschanged = () => {
                // G≈Çosy za≈Çadowane
            };
        }

        const translationCache = {};
        let currentFullText = '';

        function speakCurrentWord() {
            if (currentFullText) {
                speakPronunciation(currentFullText);
            } else {
                alert('Najpierw wpisz co≈õ do przet≈Çumaczenia!');
            }
        }

        function translate() {
            const leftText = document.getElementById('leftText').value;
            const rightText = document.getElementById('rightText');
            const pronunciationText = document.getElementById('pronunciationText');

            if (!leftText.trim()) {
                rightText.value = '';
                pronunciationText.textContent = 'Wpisz co≈õ po lewej stronie...';
                currentFullText = '';
                return;
            }

            // NAJPIERW zamie≈Ñ s≈Çowne liczby na cyfry
            let processedText = convertNumberWordsToDigits(leftText);

            // Polski ‚Üí Mitrolski
            const words = processedText.match(/[a-zƒÖƒáƒô≈Ç≈Ñ√≥≈õ≈∫≈ºA-ZƒÑƒÜƒò≈Å≈É√ì≈ö≈π≈ª0-9]+/g) || [];
            const translatedWords = words.map(word => {
                // Je≈õli to liczba (cyfra), konwertuj na system mieszany
                if (/^\d+$/.test(word)) {
                    return toMixedArabicRoman(word);
                }
                
                if (!translationCache[word]) {
                    translationCache[word] = polishToMitrolski(word);
                }
                return translationCache[word];
            });
            
            const translatedText = translatedWords.join(' ');
            rightText.value = translatedText;
            
            // Dla wymowy: t≈Çumacz liczby na mitrolski
            const pronunciationWords = processedText.match(/[a-zƒÖƒáƒô≈Ç≈Ñ√≥≈õ≈∫≈ºA-ZƒÑƒÜƒò≈Å≈É√ì≈ö≈π≈ª0-9]+/g) || [];
            const pronunciationTranslated = pronunciationWords.map(word => {
                // Je≈õli to liczba, t≈Çumacz cyfry na mitrolski
                if (/^\d+$/.test(word)) {
                    return numberToMitrolski(word);
                }
                
                if (!translationCache[word]) {
                    translationCache[word] = polishToMitrolski(word);
                }
                return translationCache[word];
            });
            
            currentFullText = pronunciationTranslated.join(' ');
            pronunciationText.innerHTML = `<strong>Wymowa:</strong> ${currentFullText}`;
        }

        document.getElementById('leftText').addEventListener('input', translate);
        
        // ======================
        // GRA QUIZ MITROLSKI
        // ======================
        
        let gameState = {
            score: 0,
            total: 0,
            streak: 0,
            withProfanity: true,
            currentWord: null,
            currentAnswer: null,
            answered: false,
            gameStarted: false
        };
        
        // Generowanie losowych s≈Ç√≥w polskich (122 s≈Çowa + 500k losowych)
        function generatePolishWords() {
            const base = Object.keys(POLISH_TO_ENGLISH);
            return base;
        }
        
        // Generator losowych polskich s≈Ç√≥w
        const SYLABY = ['ba','be','bi','bo','bu','by','ca','ce','ci','co','cu','cy',
          'da','de','di','do','du','dy','fa','fe','fi','fo','fu','fy',
          'ga','ge','gi','go','gu','gy','ha','he','hi','ho','hu','hy',
          'ja','je','ji','jo','ju','ka','ke','ki','ko','ku','ky',
          'la','le','li','lo','lu','ly','ma','me','mi','mo','mu','my',
          'na','ne','ni','no','nu','ny','pa','pe','pi','po','pu','py',
          'ra','re','ri','ro','ru','ry','sa','se','si','so','su','sy',
          'ta','te','ti','to','tu','ty','wa','we','wi','wo','wu','wy',
          'za','ze','zi','zo','zu','zy','≈Ça','≈Çe','≈Ço','≈Çu','≈ºa','≈ºe','≈ºo'];
        const KONCOWKI = ['','k','t','n','m','r','l','w','sz','cz','≈õƒá','ƒá'];
        
        function generateRandomWord() {
            const length = Math.floor(Math.random() * 3) + 2; // 2-4 sylaby
            let word = '';
            for (let i = 0; i < length; i++) {
                word += SYLABY[Math.floor(Math.random() * SYLABY.length)];
            }
            word += KONCOWKI[Math.floor(Math.random() * KONCOWKI.length)];
            return word;
        }
        
        const ALL_WORDS = generatePolishWords();
        const PROFANITY_WORDS = ['kurwa','chuj','dupa','dupek','pierdoliƒá','jebaƒá','g√≥wno','dziwka','suka','skurwysyn','zjebany','pojebany','spierdalaj','wypierdalaj','zajebisty','wkurwiony','najebany','rozjebany','pizda','cipka','fiut','kutas','cycki','sraƒá','pieprzyƒá','ruchaƒá','peda≈Ç','ciota','debil','idiota','kretyn','palant'];
        
        function openGame() {
            document.getElementById('gameModal').style.display = 'flex';
            showModeSelection();
        }
        
        function closeGame() {
            document.getElementById('gameModal').style.display = 'none';
            gameState.gameStarted = false;
        }
        
        function showModeSelection() {
            document.getElementById('modeSelection').style.display = 'block';
            document.getElementById('quizGame').style.display = 'none';
            gameState.gameStarted = false;
        }
        
        function startGame(withProfanity) {
            gameState.withProfanity = withProfanity;
            gameState.gameStarted = true;
            document.getElementById('modeSelection').style.display = 'none';
            document.getElementById('quizGame').style.display = 'block';
            resetGame();
            nextQuestion();
        }
        
        function resetGame() {
            gameState.score = 0;
            gameState.total = 0;
            gameState.streak = 0;
            updateStats();
        }
        
        function updateStats() {
            document.getElementById('gameScore').textContent = gameState.score;
            document.getElementById('gameTotal').textContent = gameState.total;
            document.getElementById('gameStreak').textContent = gameState.streak;
            const percentage = gameState.total > 0 ? Math.round((gameState.score / gameState.total) * 100) : 0;
            document.getElementById('gamePercentage').textContent = percentage + '%';
        }
        
        function getRandomWord() {
            let availableWords = [...ALL_WORDS]; // Kopiuj tablicƒô
            
            if (!gameState.withProfanity) {
                availableWords = availableWords.filter(w => !PROFANITY_WORDS.includes(w));
            }
            
            return availableWords[Math.floor(Math.random() * availableWords.length)];
        }
        
        function generateWrongAnswers(correctAnswer, count = 9) {
            const wrong = new Set();
            let attempts = 0;
            const maxAttempts = count * 100;
            
            // Generuj N b≈Çƒôdnych odpowiedzi
            while (wrong.size < count && attempts < maxAttempts) {
                attempts++;
                
                let randomWord;
                
                // 50% szans: u≈ºyj prawdziwego s≈Çowa, 50% losowego
                if (Math.random() < 0.5 && ALL_WORDS.length > 0) {
                    // Prawdziwe s≈Çowo
                    randomWord = ALL_WORDS[Math.floor(Math.random() * ALL_WORDS.length)];
                    
                    // Pomi≈Ñ je≈õli to przekle≈Ñstwo a gra bez przekle≈Ñstw
                    if (!gameState.withProfanity && PROFANITY_WORDS.includes(randomWord)) {
                        continue;
                    }
                } else {
                    // Losowe wygenerowane s≈Çowo (z 500k)
                    randomWord = generateRandomWord();
                }
                
                const wrongAnswer = polishToMitrolski(randomWord);
                
                if (wrongAnswer !== correctAnswer && wrongAnswer.length > 0) {
                    wrong.add(wrongAnswer);
                }
            }
            
            // Je≈õli nie uda≈Ço siƒô wygenerowaƒá wystarczajƒÖco, dodaj losowe
            while (wrong.size < count) {
                const fakeWord = generateRandomWord();
                const fakeAnswer = polishToMitrolski(fakeWord);
                if (fakeAnswer !== correctAnswer) {
                    wrong.add(fakeAnswer);
                }
            }
            
            return Array.from(wrong);
        }
        
        function nextQuestion() {
            gameState.answered = false;
            const word = getRandomWord();
            gameState.currentWord = word;
            
            // Tylko zwyk≈Çe s≈Çowa - bez liczb
            const correctAnswer = polishToMitrolski(word);
            gameState.currentAnswer = correctAnswer;
            
            // Wy≈õwietl pytanie
            document.getElementById('questionWord').textContent = word;
            
            // Generuj 10 opcji (1 poprawna + 9 b≈Çƒôdnych)
            const wrongAnswers = generateWrongAnswers(correctAnswer, 9);
            const allOptions = [correctAnswer, ...wrongAnswers];
            
            // Tasuj opcje
            allOptions.sort(() => Math.random() - 0.5);
            
            // Wy≈õwietl opcje (A-J)
            const letters = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'];
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            allOptions.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'option-button';
                button.innerHTML = `<span class="option-letter">${letters[index]}</span> ${option}`;
                button.onclick = () => selectAnswer(option, button);
                optionsContainer.appendChild(button);
            });
            
            document.getElementById('feedback').style.display = 'none';
        }
        
        function selectAnswer(selectedAnswer, button) {
            if (gameState.answered) return;
            
            gameState.answered = true;
            gameState.total++;
            
            const correct = selectedAnswer === gameState.currentAnswer;
            
            // Pokoloruj wszystkie opcje
            const allButtons = document.querySelectorAll('.option-button');
            allButtons.forEach(btn => {
                btn.disabled = true;
                const text = btn.textContent.substring(2).trim(); // Usu≈Ñ "A ", "B " etc
                if (text === gameState.currentAnswer) {
                    btn.classList.add('correct-answer');
                }
            });
            
            if (correct) {
                gameState.score++;
                gameState.streak++;
                button.classList.add('selected-correct');
                showFeedback(true);
            } else {
                gameState.streak = 0;
                button.classList.add('selected-wrong');
                showFeedback(false);
            }
            
            updateStats();
            
            // Nastƒôpne pytanie po 2.5 sekundach
            setTimeout(() => {
                nextQuestion();
            }, 2500);
        }
        
        function showFeedback(correct) {
            const feedback = document.getElementById('feedback');
            feedback.style.display = 'block';
            
            if (correct) {
                feedback.className = 'feedback correct';
                feedback.textContent = `‚úÖ Brawo! Poprawna odpowied≈∫!`;
            } else {
                feedback.className = 'feedback wrong';
                feedback.textContent = `‚ùå B≈ÇƒÖd! Poprawna odpowied≈∫ zosta≈Ça pod≈õwietlona na zielono.`;
            }
        }
    </script>
    
    <!-- MODAL GRY -->
    <div id="gameModal" class="game-modal">
        <div class="game-content">
            <div class="game-header">
                <h2>üéÆ Quiz Mitrolski</h2>
                <button class="close-game" onclick="closeGame()">‚úï</button>
            </div>
            
            <!-- EKRAN WYBORU TRYBU -->
            <div id="modeSelection">
                <div style="text-align: center; padding: 40px 20px;">
                    <h3 style="font-size: 28px; margin-bottom: 20px; color: #333;">Wybierz tryb gry:</h3>
                    <p style="font-size: 16px; color: #666; margin-bottom: 40px;">Niesko≈Ñczona liczba pyta≈Ñ ‚Ä¢ 500 122 s≈Çowa ‚Ä¢ 10 opcji</p>
                    
                    <div style="display: grid; gap: 20px; max-width: 500px; margin: 0 auto;">
                        <button onclick="startGame(true)" style="padding: 30px; font-size: 22px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border: none; border-radius: 15px; cursor: pointer; font-weight: bold; box-shadow: 0 8px 20px rgba(245, 87, 108, 0.4); transition: all 0.3s;">
                            üî• Z przekle≈Ñstwami<br>
                            <small style="font-size: 14px; opacity: 0.9; font-weight: normal;">Pe≈Çna wersja - wszystkie s≈Çowa</small>
                        </button>
                        
                        <button onclick="startGame(false)" style="padding: 30px; font-size: 22px; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); color: #333; border: none; border-radius: 15px; cursor: pointer; font-weight: bold; box-shadow: 0 8px 20px rgba(168, 237, 234, 0.4); transition: all 0.3s;">
                            ‚ú® Bez przekle≈Ñstw<br>
                            <small style="font-size: 14px; opacity: 0.8; font-weight: normal;">Wersja rodzinna - czyste s≈Çowa</small>
                        </button>
                    </div>
                    
                    <div style="margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                        <strong>üìä O grze:</strong><br>
                        <small style="color: #666;">
                            ‚Ä¢ Niesko≈Ñczona liczba pyta≈Ñ<br>
                            ‚Ä¢ 10 opcji do wyboru (A-J)<br>
                            ‚Ä¢ ≈öledzenie trafno≈õci i serii<br>
                            ‚Ä¢ 500 122 s≈Çowa do nauki
                        </small>
                    </div>
                </div>
            </div>
            
            <!-- EKRAN QUIZU -->
            <div id="quizGame" style="display: none;">
                <div class="game-stats">
                    <div class="stat-box">
                        <div class="stat-value" id="gameScore">0</div>
                        <div class="stat-label">Poprawne</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="gameTotal">0</div>
                        <div class="stat-label">Wszystkie</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="gameStreak">0</div>
                        <div class="stat-label">Seria</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="gamePercentage">0%</div>
                        <div class="stat-label">Trafno≈õƒá</div>
                    </div>
                </div>
                
                <div class="question-box">
                    <div class="question-text">Jak siƒô pisze po mitrolsku:</div>
                    <div class="question-subtext" id="questionWord" style="font-size: 36px; font-weight: bold; color: #667eea; margin: 25px 0;">...</div>
                    
                    <div id="optionsContainer" style="display: grid; gap: 15px; margin-top: 20px; max-height: 500px; overflow-y: auto; padding-right: 10px;">
                        <!-- Opcje generowane dynamicznie -->
                    </div>
                </div>
                
                <div id="feedback" class="feedback" style="display: none;"></div>
                
                <div style="margin-top: 20px; text-align: center;">
                    <button onclick="showModeSelection()" style="padding: 10px 20px; background: #f0f0f0; color: #666; border: none; border-radius: 8px; cursor: pointer; font-size: 14px;">
                        ‚Üê Zmie≈Ñ tryb gry
                    </button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
